\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{beamerouterthemeSURFsara}[2018/06/07 SURFsara beamer inner theme]

\RequirePackage[absolute,overlay]{textpos}
\RequirePackage{tikz}

\mode
<presentation>

\setbeamertemplate{background canvas}
{
   \begin{tikzpicture}
		\fill[white!93!black, opacity=1] (0, 0) rectangle(\the\paperwidth, \the\paperheight);

      \ifx\surf@frontcover\undefined
         \PackageWarning{BeamerSURFsara}
         {Background of front cover has not been set yet. Please rerun}
         {Background of front cover has not been set yet. Please rerun}
      \else
   		\ifnum\thepage=\surf@frontcover\relax%
            \fill[SURFsaraGreen, opacity=1] (0, 0) rectangle(\the\paperwidth, \the\paperheight);
         \fi
      \fi
	\end{tikzpicture}
}

\setbeamertemplate{background}
{
   \begin{tikzpicture}
		% Don't stray outside the paper dimensions.
	   \useasboundingbox (0, 0) rectangle(\the\paperwidth, \the\paperheight);
      \ifx\surf@titlepagepage\undefined
         \PackageWarning{BeamerSURFsara}
         {title page page number undetermined yet. Please rerun}
         {You need to rerun in order to get the title page number right}
      \else
   		\ifnum\thepage=\surf@titlepagepage\relax%
	   		% Set a solid bar at the left side of the page
		   	\fill[color=SURFsaraGreen] (0, 0) rectangle(.175\paperwidth, \the\paperheight);
         \fi
		\fi
	\end{tikzpicture}
}

\IfStrEqCase{\surf@variant}%
   {%
      {surfsara}{\def\surf@logo{SURFsara_logo}}%
      {surf}{\def\surf@logo{SURF_logo}}%
   }

\titlegraphic{\includegraphics[height=4ex]{\surf@logo}}

% Define where the element of the title page are placed
\setbeamertemplate{title page}
{
   \write\@auxout{\gdef\noexpand\surf@titlepagepage{\thepage}}
   \begin{textblock*}{.675\pagewidth}(.25\pagewidth, .275\pageheight)
      \begin{beamercolorbox}{title page header}
         \usebeamerfont{title}\usebeamercolor{title}\color{fg}\inserttitle
      \end{beamercolorbox}%
      \vskip1ex%
      \begin{beamercolorbox}[wd=.65\paperwidth]{subtitle page header}
         \usebeamerfont{subtitle}\usebeamercolor{subtitle}\color{fg}\insertsubtitle
      \end{beamercolorbox}%
      \vskip4ex%
      \begin{beamercolorbox}[wd=.65\paperwidth, left]{author}
         \usebeamerfont{author}\usebeamercolor{author}\color{fg}\insertauthor
      \end{beamercolorbox}%
   \end{textblock*}
   \begin{textblock*}{.675\pagewidth}(.25\pagewidth, .72\pageheight)
      \begin{beamercolorbox}[center]{date}
         \usebeamerfont{date}\usebeamercolor{date}\color{fg}\insertdate
      \end{beamercolorbox}%
      \begin{beamercolorbox}[center]{location}
         \usebeamerfont{location}\usebeamercolor{location}\color{fg}\insertlocation
      \end{beamercolorbox}%
      \vskip2.5ex%
      \begin{beamercolorbox}[center]{logo}
         \inserttitlegraphic
      \end{beamercolorbox}%
   \end{textblock*}
}

\setbeamercolor{bottomstopbar}{fg=black,bg=SURFsaraGreen}

\setbeamertemplate{footline}
{
   \hbox{%
      \begin{beamercolorbox}[wd=.05\paperwidth, ht=2.25ex, dp=1ex, center]{author in head/foot}%
         \includegraphics[height=2.25ex]{\surf@logo}
      \end{beamercolorbox}%
      \begin{beamercolorbox}[wd=.283333\paperwidth, ht=2.25ex, dp=1ex, center]{author in head/foot}%
         \usebeamerfont{author in head/foot}\insertshortauthor\expandafter\beamer@ifempty\expandafter{\beamer@shortinstitute}{}{~~(\insertshortinstitute)}
      \end{beamercolorbox}%
      \begin{beamercolorbox}[wd=.333333\paperwidth, ht=2.25ex, dp=1ex, center]{title in head/foot}%
         \usebeamerfont{title in head/foot}\insertshorttitle
      \end{beamercolorbox}%
      \begin{beamercolorbox}[wd=.333333\paperwidth, ht=2.25ex, dp=1ex, right]{date in head/foot}%
         \usebeamerfont{date in head/foot}\insertshortdate{}\hspace*{2em}
         \usebeamerfont{page number in head/foot}\usebeamercolor[fg]{page number in head/foot}\insertframenumber{} / \inserttotalframenumber\hspace*{2ex}
      \end{beamercolorbox}%
   }%
   \vskip0pt%
   \begin{beamercolorbox}[ht=1mm, wd=\pagewidth]{bottomstopbar}
   \end{beamercolorbox}%
}

\addtobeamertemplate{frametitle}{}{\vspace*{1.5ex}}

\defbeamertemplate*{frontcover}{surfsara}{
   \write\@auxout{\gdef\noexpand\surf@frontcover{\thepage}}
   \begin{center}
      \includegraphics[scale=1.5]{\surf@logo}
   \end{center}
}

\def\frontcover{\usebeamertemplate*{frontcover}}

\setbeamertemplate{navigation symbols}{}

\mode
<all>
